<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Customizable Number Spinner</title>
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    margin: 0;
    background: #f0f0f0;
  }
  #controls {
    padding: 15px;
    background: white;
    box-shadow: 0 2px 5px rgba(0,0,0,0.15);
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    justify-content: center;
  }
  #controls div {
    display: flex;
    flex-direction: column;
    min-width: 100px;
  }
  label {
    font-size: 0.9rem;
    margin-bottom: 4px;
  }
  input[type=number], input[type=color] {
    padding: 5px;
    font-size: 1rem;
  }
  button {
    padding: 10px 20px;
    font-size: 1rem;
    border: none;
    background: #0077cc;
    color: white;
    border-radius: 6px;
    cursor: pointer;
  }
  button:hover { background: #005fa3; }
  #colorPickers {
    display: flex;
    flex-wrap: wrap;
    gap: 5px;
    align-items: center;
  }
  #spinner-container {
    position: relative;
    margin: 20px auto;
    width: 500px;
    height: 500px;
  }
  #spinner {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    touch-action: manipulation;
    transform-origin: 50% 50%;
  }
  #arrow {
    position: absolute;
    top: -20px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 40px;
    color: red;
    z-index: 10;
  }
</style>
</head>
<body>

<div id="controls">
  <div>
    <label for="minNumber">Min Number:</label>
    <input type="number" id="minNumber" value="0">
  </div>
  <div>
    <label for="maxNumber">Max Number:</label>
    <input type="number" id="maxNumber" value="9">
  </div>
  <div>
    <label for="fontSize">Number Font Size (px):</label>
    <input type="number" id="fontSize" value="30" min="10" max="100">
  </div>
  <div>
    <label>Colors:</label>
    <div id="colorPickers">
      <input type="color" value="#ff6666">
      <input type="color" value="#66ccff">
      <input type="color" value="#99ff99">
      <button id="addColorBtn">+</button>
    </div>
  </div>
  <button id="buildBtn">Build Spinner</button>
</div>

<div id="spinner-container">
  <div id="arrow">â–¼</div>
  <canvas id="spinner"></canvas>
</div>

<script>
(() => {
  const canvas = document.getElementById("spinner");
  const ctx = canvas.getContext("2d");
  const buildBtn = document.getElementById("buildBtn");
  const addColorBtn = document.getElementById("addColorBtn");
  const colorPickersDiv = document.getElementById("colorPickers");
  const spinnerContainer = document.getElementById("spinner-container");

  let numbers = [];
  let colors = [];
  let angle = 0;
  let spinning = false;

  canvas.width = 500;
  canvas.height = 500;

  function getColors() {
    return Array.from(colorPickersDiv.querySelectorAll('input[type=color]')).map(input => input.value);
  }

  function buildSpinner() {
    const min = parseInt(document.getElementById("minNumber").value);
    const max = parseInt(document.getElementById("maxNumber").value);
    const fontSizeInput = parseInt(document.getElementById("fontSize").value) || 30;
    colors = getColors();
    numbers = [];
    for (let i = min; i <= max; i++) numbers.push(i);

    drawSpinner(fontSizeInput);
  }

  function drawSpinner(fontSize) {
    const radius = canvas.width / 2;
    const sliceAngle = (2 * Math.PI) / numbers.length;
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    numbers.forEach((num, i) => {
      const startAngle = i * sliceAngle;
      const endAngle = (i + 1) * sliceAngle;

      // slice
      ctx.beginPath();
      ctx.moveTo(radius, radius);
      ctx.arc(radius, radius, radius, startAngle, endAngle);
      ctx.closePath();
      ctx.fillStyle = colors[i % colors.length];
      ctx.fill();
      ctx.stroke();

      // text
      ctx.save();
      ctx.translate(radius, radius);
      ctx.rotate(startAngle + sliceAngle / 2);
      ctx.textAlign = "right";
      ctx.fillStyle = "#000";
      ctx.font = `bold ${fontSize}px Arial`;
      ctx.fillText(num, radius - 10, 10);
      ctx.restore();
    });
  }

  function spin() {
    if (spinning || numbers.length === 0) return;
    spinning = true;

    const sliceAngle = 2 * Math.PI / numbers.length;

    // pick a truly random target
    const targetIndex = Math.floor(Math.random() * numbers.length);
    const randomOffset = Math.random() * sliceAngle; // random inside slice

    // extra rotations for realism
    const extraRotations = Math.floor(Math.random() * 15) + 15;

    const targetAngle = extraRotations * 2 * Math.PI +
                        (numbers.length - targetIndex) * sliceAngle -
                        sliceAngle / 2 + randomOffset;

    const spinDuration = 2.5 + Math.random() * 1.5;

    canvas.style.transition = 'none';
    canvas.style.transform = `rotate(0rad)`;
    void canvas.offsetWidth;

    canvas.style.transition = `transform ${spinDuration}s cubic-bezier(0.33, 1, 0.68, 1)`;
    canvas.style.transform = `rotate(${targetAngle}rad)`;

    setTimeout(() => {
      spinning = false;
      angle = targetAngle % (2 * Math.PI);
    }, spinDuration * 1000);
  }

  buildBtn.addEventListener("click", buildSpinner);
  spinnerContainer.addEventListener("click", spin);
  spinnerContainer.addEventListener("touchstart", spin);

  addColorBtn.addEventListener("click", () => {
    const newColor = document.createElement("input");
    newColor.type = "color";
    newColor.value = "#ffffff";
    colorPickersDiv.insertBefore(newColor, addColorBtn);
  });

  buildSpinner();
})();
</script>

</body>
</html>
